name: Pipeline de Integración Continua (CI)

# 1. ¿Cuándo se activa el robot?
# Se activará cada vez que hagas un 'push' o un 'pull request' a la rama 'main'
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

# 2. ¿Qué tareas va a realizar?
jobs:
  # --- TAREA 1: VERIFICAR EL FRONTEND ---
  build-frontend:
    runs-on: ubuntu-latest # Usamos una máquina virtual Linux prestada por GitHub

    steps:
    - name: Descargar el código del repositorio
      uses: actions/checkout@v4

    - name: Configurar Node.js versión 18
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        cache-dependency-path: frontend/package-lock.json

    - name: Instalar dependencias del Frontend
      run: |
        cd frontend
        npm ci  # 'npm ci' es más rápido y seguro que 'npm install' para pipelines

    - name: Intentar construir (Build) el Frontend
      run: |
        cd frontend
        # Esto verifica si React compila bien sin errores de sintaxis
        # Nota: Usamos una variable para tratar los warnings como no fatales si es necesario, 
        # pero por defecto React falla el build si hay warnings en CI.
        npm run build --if-present
      env:
        CI: false # Ponemos false para que el build no falle por warnings simples (como el de los <a> href)

  # --- TAREA 2: VERIFICAR EL BACKEND ---
  build-backend:
    runs-on: ubuntu-latest

    steps:
    - name: Descargar el código
      uses: actions/checkout@v4

    - name: Configurar Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        cache-dependency-path: backend/package-lock.json

    - name: Instalar dependencias del Backend
      run: |
        cd backend
        npm ci

    - name: Verificar sintaxis (Opcional - Test básico)
      run: |
        cd backend
        # Aquí podríamos correr 'npm test' si tuvieras tests configurados.
        # Por ahora, solo verificamos que las dependencias instalen bien.
        echo "Backend dependencias instaladas correctamente."
```
